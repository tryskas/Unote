{% extends "notes/base.html" %}
{% block content %}
{% if user.user_type == 'teacher' %}
<form  action="{% url 'users:profview_grades' %}"  method="post">
  {% csrf_token %}

  <table>
    <thead>
        <th colspan="7"><select  name="subj" required>
          <option value="" disabled selected hidden>Matière</option>
          {% for subject in subjects %}
          <option value="{{ subject }}">{{ subject }}</option>
          {% endfor %}
      </select></th>
        <th><select  name="group" required>
          <option value="" disabled selected hidden>Classe</option>
          {% for g in groups %}
          <option value="{{ g }}">{{ g }}</option>
          {% endfor %}
      </select></th>
    </thead>
    
    <tbody>
    {% if no_grades %}
      <tr>
        <td></td>
      </tr>
    {% else %}
      <tr>
        <td></td>
        {% for i in grade_range %}
        <td>Note {{ forloop.counter }}</td>
        {% endfor %}
        <td>Moyenne</td>
      </tr>
      {% for s in students %}
      {% with i=forloop.counter %}
        <tr>
          <td>{{ s.first_name }} {{ s.last_name }} </td>
          {% for g in grades|slice:i|last %}
          <td>{{ g.grade }}</td>
          {% endfor %}
          {% with j=forloop.counter %}
              <td style="font-weight:900;" >{{ stud_ave|slice:j|last }}</td>
          {% endwith %}
        </tr>
      {% endwith %}
      {% endfor %}
      <tr>
        <td>Moyenne</td>
        {% for c in class_ave %}
        
            <td style="font-weight:900;">{{ c }}</td>
        {% endfor %}
        <td></td>
      </tr>
        
    </tbody>
  
  {% endif %}
  </table>


  <button type="submit" >Chercher</button>
  <button onclick="window.location.href='{% url 'users:profview' %}'">Ajouter une note</button>

</form>
{% else %}
  <div>
    Vous n'êtes pas autorisé à accéder à cette page ! 
    </div>
{% endif %}


{% endblock %}
