{% extends "notes/base.html" %}
{% block content %}
{% if user.user_type == 'teacher' %}
<form action="{% url 'users:profview_grades' %}" method="post">
  {% csrf_token %}

  <table>
    <thead>
      <tr>
        <th colspan="7">
          <select name="subj" required>
            <option value="" disabled selected hidden>Matière</option>
            {% for subject in subjects %}
            <option value="{{ subject }}">{{ subject }}</option>
            {% endfor %}
          </select>
        </th>
        <th>
          <select name="group" required>
            <option value="" disabled selected hidden>Classe</option>
            {% for g in groups %}
            <option value="{{ g }}">{{ g }}</option>
            {% endfor %}
          </select>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td></td>
        {% for i in grade_range %}
        <td>Note {{ forloop.counter }}</td>
        {% endfor %}
        <td>Moyenne</td>
      </tr>
      {% for s in students %}
      {% with i=forloop.counter %}
      <tr>
        <td>{{ s.first_name }} {{ s.last_name }}</td>
        {% for g in grades|slice:i|last %}
        <td>
          {{ g.grade }}
          <form action="{% url 'delete_grade' g.id %}" method="post" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="styled-button delete-button">Supprimer</button>
          </form>
        </td>
        {% endfor %}
        <td>moy</td>
      </tr>
      {% endwith %}
      {% endfor %}
      <tr>
        <td>moyenne</td>
      </tr>
    </tbody>
  </table>

  <div class="button-container">
    <button type="submit" class="styled-button">Chercher</button>
  </div>
</form>

<style>
  .styled-button {
    background-color: #4CAF50; /* Green */
    border: none;
    color: white;
    padding: 10px 24px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 8px;
  }

  .styled-button:hover {
    background-color: #45a049;
  }

  .delete-button {
    background-color: #f44336; /* Red */
  }

  .delete-button:hover {
    background-color: #e53935;
  }

  .button-container {
    text-align: center;
    margin-top: 20px;
  }
</style>

{% else %}
  <div>
    Vous n'êtes pas autorisé à accéder à cette page !
  </div>
{% endif %}
{% endblock %}